# 관리자 포탈 사용자 여정 스토리보드

**문서번호**: MPK-UX-SB-ADMIN-v1.0
**기준**: 사이트맵 v1.1 (/admin/*)
**Phase**: Phase 3 (웹 전용)
**최종 갱신**: 2026-02-15

---

## 장면 1: 총괄 대시보드

### 와이어프레임
```
┌───────────────────────────────────────────────────┐
│ 🏢 만파식 관리자 포탈          홍길동 ▼  🔔(3)  🌐│
├───────────┬───────────────────────────────────────┤
│           │                                       │
│ 📊 대시보드│ KPI 현황                               │
│ 👥 사용자  │ ┌──────────┐┌──────────┐┌──────────┐ │
│ ⚙️ 시스템  │ │ 👥 총 사용자││ 📏 오늘    ││ 📡 활성   │ │
│ 📋 감사    │ │ 152,340   ││ 측정 건수  ││ 리더기    │ │
│ 📈 모니터링│ │ ↑3.2%    ││ 45,120   ││ 89,234   │ │
│ 🏗️ 계층관리│ │ (전월대비) ││ ↑8.5%    ││ ↑2.1%   │ │
│ 📑 규제    │ └──────────┘└──────────┘└──────────┘ │
│           │ ┌──────────┐                         │
│           │ │ 💰 월 매출 │                         │
│           │ │₩2.3억    │                         │
│           │ │ ↑12.3%   │                         │
│           │ └──────────┘                         │
│           │                                       │
│           │ 📋 최근 활동 로그                       │
│           │ ┌───────────────────────────────────┐ │
│           │ │ 14:32 긴급이벤트 홍OO 혈당285 🔴    │ │
│           │ │ 14:15 신규가입 50건 (오늘 누적)    │ │
│           │ │ 13:50 카트리지 재고 부족 알림 🟡    │ │
│           │ │ 13:22 시스템 배포 v2.3.1 완료 ✅   │ │
│           │ │ 12:00 일간 리포트 자동 생성 ✅     │ │
│           │ └───────────────────────────────────┘ │
│           │                                       │
│           │ 🖥️ 시스템 상태                          │
│           │ ┌───────────────────────────────────┐ │
│           │ │ auth-service        ✅ 정상 12ms  │ │
│           │ │ health-record-svc   ✅ 정상 25ms  │ │
│           │ │ notification-svc    ✅ 정상 18ms  │ │
│           │ │ payment-svc         ⚠️ 지연 250ms │ │
│           │ │ telemedicine-svc    ✅ 정상 30ms  │ │
│           │ │ ai-coach-svc        ✅ 정상 45ms  │ │
│           │ └───────────────────────────────────┘ │
│           │                                       │
│           │ 관리 메뉴                              │
│           │ ┌────────┐┌────────┐┌────────┐┌────────┐│
│           │ │ 👥     ││ ⚙️     ││ 📋     ││ 📈     ││
│           │ │ 사용자 ││ 시스템 ││ 감사   ││모니터링││
│           │ │ 관리   ││ 설정   ││ 로그   ││       ││
│           │ └────────┘└────────┘└────────┘└────────┘│
└───────────┴───────────────────────────────────────┘
```

### 설명
- **KPI 통계 카드**: 총 사용자 수, 오늘 측정 건수, 활성 리더기 수, 월 매출을 카드 형태로 표시한다. 전월 대비 증감률을 함께 표시한다.
- **최근 활동 로그**: 긴급 이벤트, 신규 가입, 재고 알림, 시스템 배포 등 주요 활동을 실시간 타임라인으로 표시한다.
- **시스템 상태**: 각 마이크로서비스의 헬스체크 결과를 응답 시간과 함께 표시한다. 이상 시 경고 표시.
- **관리 메뉴 그리드**: 사용자 관리, 시스템 설정, 감사 로그, 모니터링 4개 주요 메뉴를 그리드로 제공한다.

### UX 포인트
- KPI 카드: 클릭 시 해당 지표 상세 차트(일별/주별/월별 추이) 표시
- 활동 로그: 실시간 업데이트 (WebSocket), 클릭 시 상세 보기
- 시스템 상태: 30초 간격 자동 갱신, 이상 감지 시 알림
- AdminService.GetDashboard RPC 호출

### 접근성
- KPI 카드: 스크린리더 "총 사용자 152,340명, 전월 대비 3.2퍼센트 증가"
- 시스템 상태: "payment-service, 지연, 응답시간 250밀리초"
- 사이드바 메뉴: 키보드 네비게이션 지원, Tab 순서 보장

### 음성 안내 (TTS)
> "관리자 대시보드입니다. 현재 총 사용자 152,340명, 오늘 측정 건수 45,120건입니다."

---

## 장면 2: 사용자 관리

### 와이어프레임
```
┌───────────────────────────────────────────────────┐
│ 🏢 만파식 관리자 포탈          홍길동 ▼  🔔(3)  🌐│
├───────────┬───────────────────────────────────────┤
│           │                                       │
│ 📊 대시보드│ 👥 사용자 관리                          │
│ 👥 사용자 ◀│                                       │
│ ⚙️ 시스템  │ 🔍 [검색: 이름, 이메일, ID       ]    │
│ 📋 감사    │                                       │
│ 📈 모니터링│ 필터:                                  │
│ 🏗️ 계층관리│ [전체▼] [구독: 전체▼] [상태: 전체▼]    │
│ 📑 규제    │ [가입일: 전체▼] [정렬: 최근가입▼]      │
│           │                                       │
│           │ 선택: 0건  [대량 작업 ▼]               │
│           │ ┌─────────────────────────────────────┐│
│           │ │☐│이름    │이메일         │등급  │가입일    │상태│액션││
│           │ ├─┼────────┼──────────────┼─────┼────────┼───┼───┤│
│           │ │☐│김철수  │kim@email.com │Pro  │02-14   │활성│[⋯]││
│           │ │☐│이영희  │lee@email.com │Basic│02-13   │활성│[⋯]││
│           │ │☐│박민수  │park@mail.com │Free │02-12   │활성│[⋯]││
│           │ │☐│정수진  │jung@mail.com │Pro  │02-10   │정지│[⋯]││
│           │ │☐│최동현  │choi@mail.com │Clin.│02-08   │활성│[⋯]││
│           │ └─────────────────────────────────────┘│
│           │                                       │
│           │ ◀ 1 2 3 ... 152 ▶  (총 152,340명)     │
│           │                                       │
│           │ ┌─ 사용자 상세 (사이드 패널) ─────────┐ │
│           │ │ 김철수                              │ │
│           │ │ kim@email.com                      │ │
│           │ │ 구독: Pro (2026-01-15 ~)           │ │
│           │ │ 리더기: 3대 연결                    │ │
│           │ │ 총 측정: 456회                      │ │
│           │ │ 마지막 접속: 2시간 전               │ │
│           │ │                                    │ │
│           │ │ [상세 보기] [계정 정지] [비밀번호   │ │
│           │ │             초기화]                 │ │
│           │ └────────────────────────────────────┘ │
└───────────┴───────────────────────────────────────┘
```

### 설명
- **검색 바**: 이름, 이메일, 사용자 ID로 실시간 검색한다.
- **필터**: 구독 등급(Free/Basic/Pro/Clinical), 가입일, 상태(활성/정지/탈퇴), 정렬 기준을 조합하여 필터링한다.
- **사용자 테이블**: 이름, 이메일, 구독 등급, 가입일, 상태를 테이블 형태로 표시한다.
- **상세 보기 사이드 패널**: 행 클릭 시 우측 사이드 패널에 사용자 상세 정보를 표시한다.
- **계정 정지/해제**: 관리자가 계정을 정지하거나 해제할 수 있다.
- **대량 작업**: 체크박스로 복수 사용자 선택 후 일괄 이메일 발송, 구독 변경, 계정 상태 변경 등을 실행한다.

### UX 포인트
- 검색: 디바운스 300ms, 실시간 결과 갱신
- 정렬: 열 헤더 클릭으로 오름차순/내림차순 전환
- 페이지네이션: 페이지당 50건, 무한 스크롤 옵션
- 계정 정지 시: 사유 입력 필수 + 해당 사용자에게 이메일/푸시 알림 전송
- AdminService.ListUsers, AdminService.UpdateUserStatus RPC 호출

### 접근성
- 테이블: 열 헤더 th 태그, 정렬 상태 aria-sort 적용
- 체크박스: "김철수 선택, 체크되지 않음"
- 사이드 패널: ESC 키로 닫기, 포커스 트랩 적용
- 페이지네이션: "152페이지 중 1페이지, 총 152,340명"

### 음성 안내 (TTS)
> "사용자 관리 화면입니다. 검색과 필터로 사용자를 찾을 수 있습니다. 총 152,340명의 사용자가 등록되어 있습니다."

---

## 장면 3: 계층형 관리 (Phase 3 후반)

### 와이어프레임
```
┌───────────────────────────────────────────────────┐
│ 🏢 만파식 관리자 포탈          홍길동 ▼  🔔(3)  🌐│
├───────────┬───────────────────────────────────────┤
│           │                                       │
│ 📊 대시보드│ 🏗️ 계층형 관리                          │
│ 👥 사용자  │                                       │
│ ⚙️ 시스템  │ 📍 현재 위치: 총괄 > 대한민국 > 서울    │
│ 📋 감사    │                                       │
│ 📈 모니터링│ 조직 트리                               │
│ 🏗️ 계층 ◀ │ ┌───────────────────────────────────┐ │
│ 📑 규제    │ │ 🌐 총괄 본부                       │ │
│           │ │ ├── 🇰🇷 대한민국                    │ │
│           │ │ │   ├── 📍 서울 ◀ (현재)            │ │
│           │ │ │   │   ├── 🏢 강남지점             │ │
│           │ │ │   │   │   ├── 🏪 A판매점          │ │
│           │ │ │   │   │   └── 🏪 B판매점          │ │
│           │ │ │   │   └── 🏢 종로지점             │ │
│           │ │ │   │       └── 🏪 C판매점          │ │
│           │ │ │   ├── 📍 부산                     │ │
│           │ │ │   └── 📍 대전                     │ │
│           │ │ ├── 🇯🇵 일본                        │ │
│           │ │ └── 🇺🇸 미국                        │ │
│           │ └───────────────────────────────────┘ │
│           │                                       │
│           │ 📊 서울 지역 KPI                        │
│           │ ┌──────────┐┌──────────┐┌──────────┐ │
│           │ │ 👥 사용자 ││ 📏 측정   ││ 📦 재고   │ │
│           │ │ 45,230   ││ 12,340   ││ 충분 ✅  │ │
│           │ │ ↑5.1%    ││ ↑10.2%   ││ 3개월분  │ │
│           │ └──────────┘└──────────┘└──────────┘ │
│           │                                       │
│           │ 📦 재고/공급망 현황                      │
│           │ ┌───────────────────────────────────┐ │
│           │ │ 혈당 카트리지   12,500개 ✅ 충분   │ │
│           │ │ 지질 카트리지    3,200개 🟡 보통   │ │
│           │ │ 호르몬 카트리지    800개 🔴 부족   │ │
│           │ │                    [발주 요청]    │ │
│           │ └───────────────────────────────────┘ │
└───────────┴───────────────────────────────────────┘
```

### 설명
- **조직 트리**: 총괄 → 국가별 → 지역별 → 지점별 → 판매점별 5단계 계층 구조를 트리 형태로 표시한다.
- **계층별 KPI**: 선택한 계층의 사용자 수, 측정 건수, 재고 현황 등 핵심 지표를 표시한다.
- **재고/공급망 현황**: 카트리지 종류별 재고 수량과 상태(충분/보통/부족)를 표시하며, 부족 시 발주 요청 버튼을 제공한다.

### UX 포인트
- 트리 노드 클릭 시 해당 계층 KPI로 전환
- 빵 부스러기 네비게이션: "총괄 > 대한민국 > 서울" 경로 표시
- 재고 부족 알림: 안전 재고 이하 시 자동 알림 + 발주 추천
- 계층별 권한: 상위 관리자만 하위 계층 관리 가능
- AdminService.GetHierarchy, AdminService.GetInventory RPC 호출

### 접근성
- 트리 구조: aria-treeitem, aria-expanded 속성 적용
- 현재 위치: "현재 서울 지역 선택됨" 스크린리더 알림
- 재고 상태: "호르몬 카트리지 800개, 부족, 발주 필요"

### 음성 안내 (TTS)
> "계층형 관리입니다. 현재 서울 지역을 보고 있습니다. 조직 트리에서 다른 지역을 선택할 수 있습니다."

---

## 장면 4: 규제 준수 관리

### 와이어프레임
```
┌───────────────────────────────────────────────────┐
│ 🏢 만파식 관리자 포탈          홍길동 ▼  🔔(3)  🌐│
├───────────┬───────────────────────────────────────┤
│           │                                       │
│ 📊 대시보드│ 📑 규제 준수 관리                       │
│ 👥 사용자  │                                       │
│ ⚙️ 시스템  │ [감사로그] [데이터보존] [규제체크] [삭제]│
│ 📋 감사    │                                       │
│ 📈 모니터링│ 📋 감사 로그 뷰어                       │
│ 🏗️ 계층관리│ ┌───────────────────────────────────┐ │
│ 📑 규제  ◀│ │시각     │행위자  │행위       │대상 │ │
│           │ ├────────┼───────┼──────────┼─────┤ │
│           │ │14:32:15│시스템 │긴급알림발송│홍OO │ │
│           │ │14:30:02│김관리 │계정정지   │정OO │ │
│           │ │14:15:00│시스템 │데이터백업 │전체 │ │
│           │ │13:55:22│이관리 │권한변경   │박OO │ │
│           │ │13:40:10│시스템 │119신고   │홍OO │ │
│           │ └───────────────────────────────────┘ │
│           │ 필터: [날짜▼] [행위자▼] [행위유형▼]     │
│           │ [CSV 내보내기]                         │
│           │                                       │
│           │ ⚙️ 데이터 보존 정책                     │
│           │ ┌───────────────────────────────────┐ │
│           │ │ 건강 데이터 보존: 10년             │ │
│           │ │ 감사 로그 보존: 5년                │ │
│           │ │ 탈퇴 회원 데이터: 90일 후 삭제     │ │
│           │ │ 백업 주기: 매일 03:00 자동 백업    │ │
│           │ │ 암호화: AES-256-GCM               │ │
│           │ │                        [변경]     │ │
│           │ └───────────────────────────────────┘ │
│           │                                       │
│           │ 📊 규제 체크리스트 진행 상태             │
│           │ ┌───────────────────────────────────┐ │
│           │ │ GDPR (EU)      [████████░░] 82%   │ │
│           │ │ PIPA (한국)    [█████████░] 92%   │ │
│           │ │ HIPAA (미국)   [███████░░░] 70%   │ │
│           │ │ ISO 13485      [████████░░] 85%   │ │
│           │ │ ISO 14971      [██████████] 100%  │ │
│           │ │                    [상세 보기]     │ │
│           │ └───────────────────────────────────┘ │
│           │                                       │
│           │ 🗑️ GDPR/PIPA 데이터 삭제 요청          │
│           │ ┌───────────────────────────────────┐ │
│           │ │ 대기 중: 3건                       │ │
│           │ │                                   │ │
│           │ │ #DR-001 김OO 전체삭제 02-14 [처리] │ │
│           │ │ #DR-002 이OO 부분삭제 02-13 [처리] │ │
│           │ │ #DR-003 박OO 전체삭제 02-12 [처리] │ │
│           │ │                                   │ │
│           │ │ 법정 처리 기한: 요청일로부터 30일   │ │
│           │ └───────────────────────────────────┘ │
└───────────┴───────────────────────────────────────┘
```

### 삭제 요청 처리 다이얼로그
```
┌─────────────────────────────┐
│ 데이터 삭제 요청 처리        │
│                             │
│ 요청자: 김OO                │
│ 유형: 전체 삭제              │
│ 요청일: 2026-02-14          │
│ 기한: 2026-03-16            │
│                             │
│ 삭제 대상:                  │
│ ☑ 개인정보 (이름, 연락처)    │
│ ☑ 건강 측정 데이터           │
│ ☑ AI 분석 기록              │
│ ☑ 결제 기록 (법적 보존 제외) │
│ ☐ 감사 로그 (법적 보존 대상) │
│                             │
│ ⚠️ 감사 로그는 법적 보존      │
│ 의무에 따라 삭제할 수         │
│ 없습니다.                   │
│                             │
│ 처리 사유: [____________]   │
│                             │
│ [삭제 실행]  [보류]  [거부]  │
└─────────────────────────────┘
```

### 설명
- **감사 로그 뷰어**: 시스템 내 모든 관리 행위(계정 정지, 권한 변경, 긴급 알림, 119 신고 등)를 시각/행위자/행위/대상 형태로 기록하고 조회한다.
- **데이터 보존 정책**: 건강 데이터, 감사 로그, 탈퇴 회원 데이터의 보존 기간과 백업 주기를 설정한다.
- **규제 체크리스트**: GDPR, PIPA, HIPAA, ISO 13485, ISO 14971 등 규제 준수 진행 상태를 프로그레스 바로 표시한다.
- **GDPR/PIPA 삭제 요청**: 사용자의 데이터 삭제 요청을 접수/처리하며, 법적 보존 의무가 있는 데이터(감사 로그 등)는 삭제 불가 표시한다.

### UX 포인트
- 감사 로그: 날짜/행위자/행위 유형별 필터링, CSV 내보내기 지원
- 규제 체크리스트: 상세 보기 시 항목별 완료/미완료 상태와 담당자 표시
- 삭제 요청: 법정 기한(30일) 카운트다운, 기한 임박 시 빨간색 경고
- 삭제 실행 시: 비가역적 작업 2단계 확인 (사유 입력 + 최종 확인)
- AdminService.GetAuditLog, AdminService.ProcessDeletionRequest RPC 호출

### 접근성
- 감사 로그 테이블: 열 헤더 th 태그, 정렬 가능
- 체크리스트: "GDPR, 82퍼센트 완료"
- 삭제 요청: "3건 대기 중, 법정 처리 기한 30일"
- 모든 모달: 포커스 트랩 + ESC 키 닫기

### 음성 안내 (TTS)
> "규제 준수 관리입니다. 감사 로그, 데이터 보존 정책, 규제 체크리스트, 데이터 삭제 요청을 관리할 수 있습니다."

---

## 네비게이션 흐름

```
┌──────────────────┐
│ 관리자 대시보드    │
│ /admin            │
└────────┬─────────┘
         │
    ┌────┼────────┬──────────┬──────────┐
    │    │        │          │          │
┌───▼──┐┌▼──────┐┌▼────────┐┌▼────────┐┌▼────────┐
│사용자││시스템  ││감사 로그 ││모니터링  ││계층 관리│
│관리  ││설정   ││         ││         ││        │
│/admin││/admin ││/admin   ││/admin   ││/admin  │
│/users││/settings│/audit  ││/monitor ││/hierarchy│
└───┬──┘└───────┘└─────────┘└─────────┘└────────┘
    │
┌───▼──────────┐
│ 사용자 상세   │
│ 사이드 패널   │
├──────────────┤
│ • 상세 보기   │
│ • 계정 정지   │
│ • 비밀번호    │
│   초기화     │
└──────────────┘

┌──────────────────┐
│ 규제 준수 관리    │
│ /admin/compliance │
├──────────────────┤
│ • 감사 로그 뷰어  │
│ • 데이터 보존 정책│
│ • 규제 체크리스트 │
│ • 삭제 요청 처리  │
└──────────────────┘
```

- **AdminDashboard → Users**: 사용자 관리 메뉴 또는 관리 그리드 클릭
- **AdminDashboard → Settings**: 시스템 설정 메뉴 클릭
- **AdminDashboard → AuditLog**: 감사 로그 메뉴 클릭
- **AdminDashboard → Monitoring**: 시스템 모니터링 메뉴 클릭

---

## 기술 참조

- `backend/services/admin-service/` 관리자 서비스 구현
- `backend/shared/proto/manpasik.proto` AdminService
- 웹 프레임워크: React 또는 Flutter Web (Phase 3 결정)
- 실시간 대시보드: WebSocket + Redis Pub/Sub
- 감사 로그: 별도 감사 로그 DB (불변 저장, 삭제 불가)
- 데이터 삭제: GDPR Article 17 (잊힐 권리) 준수
- 규제 체크리스트: ISO 14971 위험관리, ISO 13485 품질관리 연동

---

## 접근성 종합

- 웹 관리자 포탈: WCAG 2.1 AA 수준 준수
- 키보드 네비게이션: 모든 기능 키보드만으로 접근 가능
- 사이드바 메뉴: Tab 순서 보장, 현재 위치 aria-current 표시
- 테이블: 열 헤더 정렬 상태, 행 선택 상태 스크린리더 알림
- 모달/다이얼로그: 포커스 트랩 + ESC 키 닫기
- 색상 대비: 모든 텍스트 4.5:1 이상, 상태 표시 아이콘 + 텍스트 병용
- 반응형: 최소 1024px 너비 지원 (태블릿 이상)
