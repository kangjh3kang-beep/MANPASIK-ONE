# 가족 관리 사용자 여정 스토리보드

**문서번호**: MPK-UX-SB-FAMILY-v1.0
**기준**: 원본 기획안 VII. 7.5절 가족 관리 시나리오 + 8.2절 독거 노인 119 연동
**Phase**: Phase 3
**최종 갱신**: 2026-02-14

---

## 장면 1: 가족 그룹 생성 및 초대

### 와이어프레임
```
┌─────────────────────────────┐
│  ◀  가족 관리                │
├─────────────────────────────┤
│                             │
│  👨‍👩‍👧‍👦 우리 가족 건강 관리     │
│                             │
│  아직 가족 그룹이 없습니다.   │
│  가족을 초대하고 함께 건강을  │
│  관리하세요!                 │
│                             │
│  [  가족 그룹 만들기  ]      │
│                             │
├─────────────────────────────┤
│ 💡 가족 관리 혜택             │
│ • 가족 멤버별 건강 대시보드   │
│ • 이상 감지 시 보호자 알림   │
│ • 독거 노인 119 자동 연동   │
│ • Pro: 최대 5명, Clinical: 10명│
└─────────────────────────────┘
```

### 그룹 생성 다이얼로그
```
┌─────────────────────────────┐
│ 가족 그룹 만들기             │
│                             │
│ 그룹 이름                    │
│ ┌─────────────────────────┐ │
│ │ 홍길동네 가족             │ │
│ └─────────────────────────┘ │
│                             │
│ 초대 방법 선택               │
│ ┌─────────────────────────┐ │
│ │ 📱 전화번호로 초대        │ │
│ │ 🔗 초대 링크 공유         │ │
│ │ 📷 QR 코드 스캔          │ │
│ └─────────────────────────┘ │
│                             │
│ 멤버 초대 (최대 5명)         │
│ ┌─────────────────────────┐ │
│ │ +82 10-0000-0000 [초대]  │ │
│ └─────────────────────────┘ │
│                             │
│ [  그룹 생성하기  ]          │
└─────────────────────────────┘
```

### 인터랙션
- FamilyService.CreateFamily RPC 호출
- 초대: SMS 또는 딥링크 전송, QR 코드 생성
- 멤버 수 제한: 구독 티어별 확인 (Free: 2명, Basic: 3명, Pro: 5명, Clinical: 10명)
- 초대 수락: 딥링크 클릭 → 앱 열기 → 가족 참여 확인

### 에러 케이스
- 티어 초과: "현재 구독으로는 최대 N명까지 초대 가능합니다. [구독 업그레이드]"
- 이미 다른 가족 소속: "이미 다른 가족 그룹에 속해있습니다. 기존 그룹을 탈퇴 후 참여해주세요."

---

## 장면 2: 가족 멤버 프로필 관리

### 와이어프레임
```
┌─────────────────────────────┐
│  ◀  멤버 관리                │
├─────────────────────────────┤
│ 멤버 추가                    │
│                             │
│ [👤 프로필 사진]              │
│                             │
│ 이름: [________________]    │
│ 관계: [아버지 ▼]            │
│ 생년월일: [1958-03-15]      │
│                             │
│ 모드 설정                    │
│ ┌─────────────────────────┐ │
│ │ ○ 일반 모드              │ │
│ │   표준 인터페이스         │ │
│ │                         │ │
│ │ ● 시니어 모드 (65세 이상) │ │
│ │   큰 글씨, 간소화 UI,    │ │
│ │   음성 안내 자동 활성화   │ │
│ │                         │ │
│ │ ○ 어린이 모드 (14세 미만) │ │
│ │   보호자 승인 필수,       │ │
│ │   제한된 기능 접근        │ │
│ └─────────────────────────┘ │
│                             │
│ 건강 관심사 (복수 선택)       │
│ [혈당] [혈압] [콜레스테롤]    │
│ [체중] [수면] [운동]         │
│                             │
│ ☑ 독거 상태 (혼자 거주)      │
│ ☑ 119 자동 연동 활성화       │
│                             │
│ [  저장하기  ]               │
└─────────────────────────────┘
```

### 인터랙션
- 시니어 모드: 폰트 크기 1.5배, 버튼 크기 1.3배, 음성 안내 기본 활성화
- 어린이 모드: 측정 기능만 허용, 마켓/결제/의료 서비스 접근 차단
- 독거 상태 체크: 119 연동 설정 섹션 표시
- FamilyService.AddMember / UpdateMember RPC 호출

---

## 장면 3: 보호자 대시보드

### 와이어프레임
```
┌─────────────────────────────┐
│  ◀  홍길동네 가족    ⚙️     │
├─────────────────────────────┤
│ 오늘의 가족 건강 요약        │
│                             │
│ ┌─────────────────────────┐ │
│ │ 👨 아버지 (시니어 모드)    │ │
│ │ ⚠️ 혈당 주의              │ │
│ │ 최근 측정: 145 mg/dL     │ │
│ │ 추세: ↑ 상승 (7일 평균)   │ │
│ │ 마지막 측정: 2시간 전      │ │
│ │ [상세보기]                │ │
│ ├─────────────────────────┤ │
│ │ 👩 어머니                 │ │
│ │ ✅ 정상 범위              │ │
│ │ 최근 측정: 98 mg/dL      │ │
│ │ 추세: ─ 안정             │ │
│ │ 마지막 측정: 5시간 전      │ │
│ │ [상세보기]                │ │
│ ├─────────────────────────┤ │
│ │ 👧 딸                    │ │
│ │ ❓ 오늘 측정 없음          │ │
│ │ 마지막 측정: 어제 18:00   │ │
│ │ [측정 리마인더 보내기]     │ │
│ └─────────────────────────┘ │
│                             │
│ 📊 가족 주간 리포트 [보기]    │
├─────────────────────────────┤
│  🏠   📊   ⬡   🛒   ⚙️   │
└─────────────────────────────┘
```

### 인터랙션
- 멤버 카드: 건강 상태 아이콘 (✅정상, ⚠️주의, 🔴위험, ❓미측정)
- 상세보기: 해당 멤버의 측정 기록 + 차트 + AI 분석
- 측정 리마인더: 해당 멤버에게 푸시 알림 전송
- 주간 리포트: 가족 전원 건강 트렌드 종합 보고서
- FamilyService.GetFamilyHealthSummary RPC 호출

---

## 장면 4: 실시간 이상 감지 알림

### 푸시 알림
```
┌─────────────────────────────┐
│ 🔴 만파식 긴급 알림           │
│                             │
│ 아버지의 혈당이 위험 수준입니다│
│ 측정값: 280 mg/dL           │
│ 시각: 14:32                 │
│                             │
│ [확인하기]  [119 연락]       │
└─────────────────────────────┘
```

### 알림 상세 화면
```
┌─────────────────────────────┐
│  ◀  긴급 알림 상세           │
├─────────────────────────────┤
│                             │
│ 🔴 위험 감지                 │
│                             │
│ 👨 아버지                    │
│ 혈당: 280 mg/dL (위험)      │
│ 정상 범위: 70~140 mg/dL     │
│                             │
│ ┌─────────────────────────┐ │
│ │ 📈 최근 24시간 혈당 추이  │ │
│ │ ▁▂▃▅▇█ ← 급격한 상승     │ │
│ └─────────────────────────┘ │
│                             │
│ AI 분석:                     │
│ "식후 급격한 혈당 상승이      │
│  감지되었습니다. 즉시 의료    │
│  전문가 상담을 권장합니다."   │
│                             │
│ 권장 조치:                   │
│ 1. 본인에게 전화 확인        │
│ 2. 의료진 상담 예약          │
│ 3. 필요 시 119 신고          │
│                             │
│ [📞 아버지에게 전화]          │
│ [🏥 긴급 진료 예약]          │
│ [🚑 119 신고]               │
└─────────────────────────────┘
```

### 인터랙션
- 위험 수준별 알림: 주의(앱 내 알림) → 경고(푸시) → 위험(푸시+사운드+진동)
- 119 신고: 위치 정보 + 환자 건강 데이터 자동 첨부
- 전화 연결: 해당 멤버 전화번호로 즉시 전화
- NotificationService + FamilyService.GetAlertSettings RPC

### 에러 케이스
- 멤버 연락 불가: "30분 내 응답이 없으면 긴급 연락처로 알림을 전송합니다."
- GPS 미확인: "위치 정보를 확인할 수 없습니다. 마지막 알려진 위치: 서울시 강남구"

---

## 장면 5: 독거 노인 119 연동 시나리오

### 시나리오 흐름
```
[자동 측정 감지] → [이상 수치 판별] → [보호자 1차 알림]
      ↓ (15분 무응답)
[보호자 2차 알림 + 긴급 연락처 알림]
      ↓ (15분 무응답)
[119 자동 신고 + 위치/건강데이터 전송]
```

### 119 자동 연동 화면
```
┌─────────────────────────────┐
│  🚑 119 긴급 신고 진행 중     │
├─────────────────────────────┤
│                             │
│ ⚠️ 30분간 보호자 응답 없음    │
│ 119 자동 신고를 진행합니다    │
│                             │
│ 전송 정보:                   │
│ ┌─────────────────────────┐ │
│ │ 환자: 홍OO (68세, 남성)   │ │
│ │ 위치: 서울시 종로구 XX동  │ │
│ │       GPS: 37.57, 126.97│ │
│ │ 상태: 혈당 320 mg/dL     │ │
│ │ 기저질환: 당뇨(Type 2)   │ │
│ │ 복용약물: 메트포르민      │ │
│ │ 혈액형: A+               │ │
│ │ 긴급연락처: 010-1234-5678│ │
│ └─────────────────────────┘ │
│                             │
│ 📞 119 연결 중...            │
│                             │
│ [신고 취소 (보호자 확인 완료)]│
└─────────────────────────────┘
```

### 인터랙션
- 자동 에스컬레이션: 15분 단위로 단계적 조치
- 119 데이터 전송: 건강 데이터 패킷 + GPS + 환자 기본 정보
- 신고 취소: 보호자가 상황 확인 후 취소 가능 (취소 사유 기록)
- 모든 과정 감사 로그 기록 (AuditLog)

### 음성 안내 (TTS - 환자 측)
> "건강 이상이 감지되었습니다. 보호자에게 알림을 전송했습니다. 괜찮으시면 '괜찮아요' 버튼을 눌러주세요."

---

## 접근성 고려사항
- 시니어 모드: 최소 폰트 20sp, 고대비 색상, 간소화된 네비게이션
- 긴급 알림: 진동 패턴 + 사운드 + 화면 깨움 (Do Not Disturb 우회)
- 119 신고 버튼: 항상 빨간색, 최소 56×56dp, 이중 확인
- 색각 이상 대응: 아이콘 + 텍스트 라벨 병용

## 참조
- 원본 기획안 VII. 7.5절, VIII. 8.2절
- `docs/ux/sitemap.md` /family 라우트
- `backend/shared/proto/manpasik.proto` FamilyService, NotificationService, HealthRecordService
