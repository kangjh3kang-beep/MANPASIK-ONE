# ISO 14971 FMEA (Failure Mode and Effects Analysis)

## ManPaSik (만파식) 차동측정 기반 헬스케어 AI 생태계

**문서 번호**: MPS-FMEA-001
**버전**: 1.0
**분류**: 기밀 (Confidential)
**작성일**: 2026-02-14
**참조**: MPS-RMP-001 (위험관리 계획서), IEC 62304, ISO 14971:2019
**RPN 기준**: Risk Priority Number = Severity(S) × Occurrence(O) × Detection(D), 각 1~10 척도

---

## 1. FMEA 범위

본 FMEA는 ManPaSik IVD 시스템의 8개 서브시스템에 대해 38개 고장 모드를 분석합니다.

| 서브시스템 | 약어 | 모듈 |
|-----------|------|------|
| BLE 통신 | BLE | `rust-core/manpasik-engine/src/ble/` |
| NFC 카트리지 | NFC | `rust-core/manpasik-engine/src/nfc/` |
| 차동측정 엔진 | DIFF | `rust-core/manpasik-engine/src/differential/` |
| 신호처리 (DSP) | DSP | `rust-core/manpasik-engine/src/dsp/` |
| AI/ML 추론 | AI | `rust-core/manpasik-engine/src/ai/` |
| 데이터 동기화 | SYNC | `rust-core/manpasik-engine/src/sync/` |
| 암호화/보안 | CRYPTO | `rust-core/manpasik-engine/src/crypto/` |
| 모바일 앱 (Flutter) | APP | `frontend/flutter-app/` |

### 1.1 심각도(S), 발생빈도(O), 검출도(D) 척도

| 등급 | 심각도 (S) | 발생빈도 (O) | 검출도 (D) |
|------|-----------|-------------|-----------|
| 1 | 영향 없음 | 거의 불가능 (<1/10⁶) | 거의 확실히 검출 |
| 2 | 매우 경미한 불편 | 극히 드묾 (1/10⁵) | 매우 높은 검출 |
| 3 | 경미한 불편 | 매우 드묾 (1/10⁴) | 높은 검출 |
| 4 | 사소한 기능 저하 | 드묾 (1/10³) | 보통 이상 검출 |
| 5 | 보통 기능 저하 | 가끔 (1/500) | 보통 검출 |
| 6 | 상당한 기능 저하 | 드물지 않음 (1/200) | 낮은 검출 |
| 7 | 높은 기능 저하 | 빈번 (1/100) | 매우 낮은 검출 |
| 8 | 심각한 영향 (치료 필요) | 매우 빈번 (1/20) | 거의 불가능 검출 |
| 9 | 위독 (영구 손상 가능) | 높은 빈도 (1/10) | 검출 불가능 |
| 10 | 치명 (사망 가능) | 매우 높음 (>1/5) | 전혀 검출 불가 |

### 1.2 RPN 판정 기준

| RPN 범위 | 위험 등급 | 조치 |
|----------|----------|------|
| 1-40 | Low (L) | 모니터링 유지 |
| 41-100 | Medium (M) | 가능한 한 위험 감소 |
| 101-200 | High (H) | 위험 감소 조치 필수 (ALARP) |
| 201+ | Unacceptable (U) | 설계 변경 필수 |

---

## 2. FMEA 테이블

### 2.1 BLE 통신 서브시스템 (FM-BLE-001 ~ FM-BLE-006)

| ID | 고장 모드 | 고장 원인 | 고장 영향 | S | O | D | RPN | 위험통제 조치 | 잔여 S | 잔여 O | 잔여 D | 잔여 RPN |
|----|----------|----------|----------|---|---|---|-----|-------------|--------|--------|--------|---------|
| FM-BLE-001 | BLE 연결 끊김 (측정 중) | RF 간섭, 거리 초과, 배터리 부족 | 불완전한 측정 데이터, 결과 미표시 | 6 | 5 | 3 | 90 | 자동 재연결 3회 + 오프라인 버퍼링 + 데이터 무결성 검증 | 6 | 2 | 2 | 24 |
| FM-BLE-002 | BLE 데이터 손상 | EMI 간섭, 패킷 손실 | 잘못된 채널 데이터 → 부정확한 측정 | 7 | 3 | 2 | 42 | CRC-16 체크섬 + 시퀀스 번호 검증 + 재전송 | 7 | 1 | 1 | 7 |
| FM-BLE-003 | BLE 스캔 실패 | 어댑터 미감지, OS 권한 부족 | 리더기 연결 불가 | 3 | 4 | 2 | 24 | 권한 안내 UI + 어댑터 상태 체크 + 대안 연결 안내 | 3 | 2 | 2 | 12 |
| FM-BLE-004 | 잘못된 디바이스 연결 | 이름 유사 디바이스, MAC 스푸핑 | 타인 리더기에 데이터 전송 | 7 | 2 | 3 | 42 | 디바이스 페어링 인증 (LESC) + 시리얼 검증 + 사용자 확인 | 7 | 1 | 2 | 14 |
| FM-BLE-005 | BLE 패킷 재조립 실패 | 청크 순서 오류, 누락 | 불완전한 896/1792차원 데이터 | 6 | 3 | 3 | 54 | 시퀀스 번호 기반 재조립 + 누락 감지 후 재요청 + 타임아웃 | 6 | 1 | 2 | 12 |
| FM-BLE-006 | 배터리 부족 상태 측정 | 저전압에서 ADC 왜곡 | 센서 읽기값 부정확 → 잘못된 결과 | 8 | 3 | 2 | 48 | 배터리 < 15% 시 측정 차단 + 경고 + 전원 검증 | 8 | 1 | 1 | 8 |

### 2.2 NFC 카트리지 서브시스템 (FM-NFC-001 ~ FM-NFC-005)

| ID | 고장 모드 | 고장 원인 | 고장 영향 | S | O | D | RPN | 위험통제 조치 | 잔여 S | 잔여 O | 잔여 D | 잔여 RPN |
|----|----------|----------|----------|---|---|---|-----|-------------|--------|--------|--------|---------|
| FM-NFC-001 | NFC 읽기 실패 | 태그 손상, 접촉 불량, 간섭 | 보정 데이터 미획득 → 기본값 사용 시 부정확한 측정 | 8 | 4 | 2 | 64 | 3회 재시도 + 실패 시 측정 차단 + 사용자 안내 | 8 | 1 | 1 | 8 |
| FM-NFC-002 | 카트리지 위조/변조 | 복제 NFC 태그 | 잘못된 보정 데이터 → 부정확한 결과 | 9 | 2 | 4 | 72 | DESFire EV3 AES-128 인증 + HMAC 서명 + 서버 검증 | 9 | 1 | 1 | 9 |
| FM-NFC-003 | 만료 카트리지 사용 | 유효기간 확인 실패 | 변질된 시약 → 부정확한 결과 | 7 | 3 | 2 | 42 | NFC 태그 내 유효기간 검증 + 만료 시 측정 차단 | 7 | 1 | 1 | 7 |
| FM-NFC-004 | 카트리지 타입 오인식 | 핑거프린트 분류 오류, 코드 손상 | 잘못된 분석 알고리즘 적용 | 8 | 2 | 3 | 48 | 이중 검증 (NFC 코드 + AI 핑거프린트) + confidence < 0.85 시 경고 | 8 | 1 | 1 | 8 |
| FM-NFC-005 | 사용 횟수 업데이트 실패 | NFC 쓰기 오류 | 사용 횟수 미차감 → 초과 사용 | 5 | 3 | 3 | 45 | 서버측 사용 기록 + 로컬/서버 교차 검증 | 5 | 1 | 2 | 10 |

### 2.3 차동측정 엔진 서브시스템 (FM-DIFF-001 ~ FM-DIFF-005)

| ID | 고장 모드 | 고장 원인 | 고장 영향 | S | O | D | RPN | 위험통제 조치 | 잔여 S | 잔여 O | 잔여 D | 잔여 RPN |
|----|----------|----------|----------|---|---|---|-----|-------------|--------|--------|--------|---------|
| FM-DIFF-001 | α 보정 계수 오류 | NFC 읽기 오류, 데이터 손상 | S_corrected = S_det - α·S_ref 계산 오류 → 부정확한 결과 | 8 | 3 | 2 | 48 | α 유효범위 검증 (0.0~2.0) + proptest + NFC 재읽기 | 8 | 1 | 1 | 8 |
| FM-DIFF-002 | 참조 채널 이상 | 센서 고장, 오염 | S_ref 왜곡 → 차동보정 실패 | 8 | 2 | 3 | 48 | 참조 채널 이상치 감지 (Z-score > 3) + 경고 + 측정 중단 | 8 | 1 | 2 | 16 |
| FM-DIFF-003 | 온도 보정 실패 | 환경 센서 고장, 극한 온도 | 온도 의존적 측정 오차 증가 | 7 | 3 | 3 | 63 | 환경 센서 자가진단 + 범위(5~45°C) 이탈 시 경고 | 7 | 1 | 2 | 14 |
| FM-DIFF-004 | 채널 수 불일치 | 카트리지-리더기 호환 오류 | 차원 불일치로 계산 오류 | 7 | 2 | 2 | 28 | 채널 수 사전 검증 (88/448/896/1792) + 불일치 시 차단 | 7 | 1 | 1 | 7 |
| FM-DIFF-005 | 수치 오버플로우/언더플로우 | 극단적 센서 값 | 계산 결과 NaN/Inf | 6 | 2 | 2 | 24 | Rust 타입 안전성 + saturating_ops + NaN/Inf 체크 | 6 | 1 | 1 | 6 |

### 2.4 신호처리 (DSP) 서브시스템 (FM-DSP-001 ~ FM-DSP-004)

| ID | 고장 모드 | 고장 원인 | 고장 영향 | S | O | D | RPN | 위험통제 조치 | 잔여 S | 잔여 O | 잔여 D | 잔여 RPN |
|----|----------|----------|----------|---|---|---|-----|-------------|--------|--------|--------|---------|
| FM-DSP-001 | FFT 계산 오류 | 입력 크기 불일치, 메모리 부족 | 주파수 영역 분석 실패 | 6 | 2 | 2 | 24 | 입력 길이 2^N 패딩 + rustfft 무결성 검증 + 결과 범위 체크 | 6 | 1 | 1 | 6 |
| FM-DSP-002 | 핑거프린트 추출 실패 | 특징 벡터 차원 오류 | 카트리지 식별 불가 | 6 | 2 | 2 | 24 | 차원 검증 (88→448→896→1792) + 실패 시 NFC 코드 폴백 | 6 | 1 | 1 | 6 |
| FM-DSP-003 | 노이즈 필터링 과잉 | 필터 파라미터 오류 | 유효 신호 손실 → 부정확한 결과 | 7 | 2 | 4 | 56 | SNR 모니터링 + 필터 응답 검증 + 원본 데이터 보존 | 7 | 1 | 2 | 14 |
| FM-DSP-004 | 시간축 확장 오류 (1792차원) | E12-IF 변환 알고리즘 버그 | 궁극 분석 결과 왜곡 | 7 | 2 | 3 | 42 | 단위 테스트 커버리지 > 90% + 참조 데이터 교차검증 | 7 | 1 | 2 | 14 |

### 2.5 AI/ML 추론 서브시스템 (FM-AI-001 ~ FM-AI-005)

| ID | 고장 모드 | 고장 원인 | 고장 영향 | S | O | D | RPN | 위험통제 조치 | 잔여 S | 잔여 O | 잔여 D | 잔여 RPN |
|----|----------|----------|----------|---|---|---|-----|-------------|--------|--------|--------|---------|
| FM-AI-001 | AI 분류 오류 (위양성) | 학습 데이터 편향, 모델 한계 | 불필요한 의료 조치/불안감 | 6 | 4 | 3 | 72 | confidence 임계값 ≥ 0.85 + "의료 전문가 확인 필요" 면책 표시 | 6 | 2 | 2 | 24 |
| FM-AI-002 | AI 분류 오류 (위음성) | 학습 데이터 부족, 엣지케이스 | 비정상 수치 미감지 → 치료 지연 | 9 | 3 | 4 | 108 | 규칙 기반 임계값 이중 체크 + AI+규칙 병렬 판단 + PCCP 지속 개선 | 9 | 1 | 2 | 18 |
| FM-AI-003 | TFLite 모델 로드 실패 | 파일 손상, 버전 불일치 | AI 분석 불가 | 4 | 2 | 2 | 16 | 모델 무결성 SHA-256 검증 + 폴백 모델 + 규칙 기반 대체 | 4 | 1 | 1 | 4 |
| FM-AI-004 | AI 모델 편향 (인구집단) | 학습 데이터 다양성 부족 | 특정 집단 정확도 저하 | 7 | 3 | 5 | 105 | 다양한 인구집단 학습 데이터 + 정기 공정성 감사 + 성능 모니터링 | 7 | 2 | 2 | 28 |
| FM-AI-005 | 건강 코칭 부적절 조언 | LLM 환각, 맥락 오해 | 사용자 잘못된 건강 행동 | 7 | 4 | 4 | 112 | 의료 가이드라인 기반 규칙 필터 + "의료 조언 아님" 면책 + 인간 검토 | 7 | 2 | 2 | 28 |

### 2.6 데이터 동기화 서브시스템 (FM-SYNC-001 ~ FM-SYNC-005)

| ID | 고장 모드 | 고장 원인 | 고장 영향 | S | O | D | RPN | 위험통제 조치 | 잔여 S | 잔여 O | 잔여 D | 잔여 RPN |
|----|----------|----------|----------|---|---|---|-----|-------------|--------|--------|--------|---------|
| FM-SYNC-001 | CRDT 병합 충돌 | 벡터 클록 불일치, 시계 드리프트 | 측정 데이터 중복 또는 누락 | 6 | 3 | 3 | 54 | LWW + VectorClock + 해시체인 무결성 검증 + 수동 확인 UI | 6 | 1 | 2 | 12 |
| FM-SYNC-002 | 오프라인 데이터 유실 | 스토리지 가득 참, 앱 삭제 | 측정 기록 영구 손실 | 7 | 2 | 3 | 42 | 스토리지 사용량 모니터링 + 경고 (80%/90%) + 자동 정리 정책 | 7 | 1 | 2 | 14 |
| FM-SYNC-003 | 동기화 무한 루프 | 네트워크 불안정, 서버 오류 | 배터리 소모, 데이터 트래픽 낭비 | 3 | 3 | 3 | 27 | 지수 백오프 + 최대 재시도 횟수 + 일일 동기화 한도 | 3 | 1 | 2 | 6 |
| FM-SYNC-004 | 부분 동기화 상태 | 대용량 전송 중 연결 끊김 | 일부 데이터만 서버 반영 | 5 | 4 | 3 | 60 | 트랜잭션 기반 동기화 + 체크포인트 + 재개 가능 전송 | 5 | 2 | 2 | 20 |
| FM-SYNC-005 | 72시간 오프라인 초과 | 장기 네트워크 단절 | 대량 데이터 축적 → 동기화 폭주 | 4 | 2 | 3 | 24 | 우선순위 기반 점진적 동기화 + 압축 전송 + 백그라운드 처리 | 4 | 1 | 2 | 8 |

### 2.7 암호화/보안 서브시스템 (FM-CRYPTO-001 ~ FM-CRYPTO-004)

| ID | 고장 모드 | 고장 원인 | 고장 영향 | S | O | D | RPN | 위험통제 조치 | 잔여 S | 잔여 O | 잔여 D | 잔여 RPN |
|----|----------|----------|----------|---|---|---|-----|-------------|--------|--------|--------|---------|
| FM-CRYPTO-001 | 암호화 키 유출 | 메모리 덤프, 사이드채널 공격 | PHI 데이터 대량 유출 | 9 | 2 | 4 | 72 | HSM/Secure Enclave 키 저장 + 키 로테이션(90일) + 제로트러스트 | 9 | 1 | 2 | 18 |
| FM-CRYPTO-002 | 데이터 무결성 검증 실패 | HMAC 불일치, 전송 중 변조 | 변조된 측정 데이터 사용 | 8 | 2 | 2 | 32 | HMAC-SHA256 검증 + TLS 1.3 필수 + 재전송 | 8 | 1 | 1 | 8 |
| FM-CRYPTO-003 | 인증 토큰 탈취 | XSS, 중간자 공격 | 환자 데이터 무단 접근 | 8 | 2 | 3 | 48 | JWT 단기 만료(15분) + Refresh Token 로테이션 + RBAC | 8 | 1 | 2 | 16 |
| FM-CRYPTO-004 | 저장 데이터 암호화 실패 | 키 관리 오류, 마이그레이션 버그 | PHI 평문 노출 | 9 | 1 | 3 | 27 | AES-256-GCM 필수 + 암호화 상태 감사 + CI/CD 검증 | 9 | 1 | 1 | 9 |

### 2.8 모바일 앱 서브시스템 (FM-APP-001 ~ FM-APP-004)

| ID | 고장 모드 | 고장 원인 | 고장 영향 | S | O | D | RPN | 위험통제 조치 | 잔여 S | 잔여 O | 잔여 D | 잔여 RPN |
|----|----------|----------|----------|---|---|---|-----|-------------|--------|--------|--------|---------|
| FM-APP-001 | 측정 결과 오표시 | UI 렌더링 버그, 단위 변환 오류 | 사용자 잘못된 판단 → 부적절한 자가 관리 | 8 | 3 | 2 | 48 | 단위 변환 검증 + 참조 범위 표시 + UI 자동화 테스트 | 8 | 1 | 1 | 8 |
| FM-APP-002 | 위험 알림 미전달 | 알림 권한 미설정, 서비스 중단 | 비정상 수치 미인지 → 치료 지연 | 9 | 3 | 3 | 81 | 이중 알림 (인앱+Push+SMS) + 알림 상태 모니터링 + 확인 요청 | 9 | 1 | 2 | 18 |
| FM-APP-003 | 데이터 시각화 오해 | 축 스케일 부적절, 색상 혼동 | 추세 오해석 → 잘못된 건강 관리 | 5 | 4 | 4 | 80 | WCAG 2.1 접근성 + 명확한 축 라벨 + 사용성 테스트 | 5 | 2 | 2 | 20 |
| FM-APP-004 | 오프라인 모드 데이터 일관성 | SQLite 동시 접근, CRDT 오류 | 오프라인 측정 기록 불일치 | 5 | 3 | 3 | 45 | WAL 모드 + CRDT 무결성 + 동기화 후 검증 | 5 | 1 | 2 | 10 |

---

## 3. 위험 통계 요약

### 3.1 초기 RPN 분포

| RPN 범위 | 위험 등급 | 고장 모드 수 | 비율 |
|----------|----------|------------|------|
| 1-40 | Low (L) | 9 | 23.7% |
| 41-100 | Medium (M) | 24 | 63.2% |
| 101-200 | High (H) | 5 | 13.2% |
| 201+ | Unacceptable (U) | 0 | 0% |
| **합계** | | **38** | **100%** |

### 3.2 잔여 RPN 분포 (통제 조치 후)

| RPN 범위 | 위험 등급 | 고장 모드 수 | 비율 |
|----------|----------|------------|------|
| 1-40 | Low (L) | 38 | 100% |
| 41-100 | Medium (M) | 0 | 0% |
| 101-200 | High (H) | 0 | 0% |
| 201+ | Unacceptable (U) | 0 | 0% |
| **합계** | | **38** | **100%** |

### 3.3 High 위험 고장 모드 (초기 RPN > 100)

| ID | 고장 모드 | 초기 RPN | 핵심 통제 | 잔여 RPN |
|----|----------|---------|----------|---------|
| FM-AI-002 | AI 위음성 (비정상 미감지) | 108 | 규칙 기반 이중 체크 + PCCP | 18 |
| FM-AI-004 | AI 모델 편향 | 105 | 다양한 학습 데이터 + 공정성 감사 | 28 |
| FM-AI-005 | 건강 코칭 부적절 조언 | 112 | 의료 가이드라인 필터 + 면책 | 28 |

---

## 4. 위험 통제 검증 계획

| 통제 조치 카테고리 | 검증 방법 | 시기 | 담당 |
|------------------|----------|------|------|
| BLE 자동 재연결 | 간섭 환경 시뮬레이션 테스트 | Phase 1 | QA |
| NFC DESFire 인증 | 위조 태그 시도 테스트 | Phase 1 | 보안팀 |
| α 계수 범위 검증 | proptest (속성 기반 테스트) | Phase 1 | 개발팀 |
| AI confidence 임계값 | 임상 데이터 검증 (ROC/AUC) | Phase 2 | 데이터팀 |
| 규칙 기반 이중 체크 | 양성/음성 대조군 테스트 | Phase 2 | 임상팀 |
| CRDT 무결성 | 병합 시나리오 테스트 (100+) | Phase 1 | 개발팀 |
| 암호화 키 관리 | 침투 테스트 + 코드 감사 | Phase 2 | 보안팀 |
| 알림 이중화 | 장애 주입 테스트 (Chaos) | Phase 2 | DevOps |
| 모델 공정성 감사 | 인구집단별 성능 비교 | Phase 3 | 데이터팀 |

---

## 5. 개정 이력

| 버전 | 날짜 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.0 | 2026-02-14 | 초안 작성 (38개 고장 모드, 8개 서브시스템) | Claude |

---

## 6. 부록

### 부록 A: 관련 문서

- `docs/compliance/iso14971-risk-management-plan.md` — 위험관리 계획서 (MPS-RMP-001)
- `docs/compliance/iso14971-pha.md` — 사전 위해 분석 (MPS-PHA-001)
- `docs/compliance/software-safety-classification.md` — IEC 62304 소프트웨어 안전 등급
- `docs/security/stride-threat-model.md` — STRIDE 위협 모델링 (31개 위협)

### 부록 B: 약어

| 약어 | 의미 |
|------|------|
| FMEA | Failure Mode and Effects Analysis (고장 모드 영향 분석) |
| RPN | Risk Priority Number (위험 우선순위 번호) |
| S/O/D | Severity/Occurrence/Detection (심각도/발생빈도/검출도) |
| ALARP | As Low As Reasonably Practicable |
| PCCP | Predetermined Change Control Plan (사전결정 변경통제 계획) |
| PHI | Protected Health Information (보호대상 건강정보) |
| CRDT | Conflict-free Replicated Data Type |
| LESC | Low Energy Secure Connections (BLE 보안 연결) |
